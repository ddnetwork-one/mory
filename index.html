<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MORY</title>
    
    <!-- FAVICON CODE HERE -->
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/ddnetwork-ent/mory-matcha/refs/heads/main/MORY%20ICON-green.png">
    
    <!-- Fonts: Inter / System -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- CSS VARIABLES --- */
        :root {
            --bg-main: #fbfaf7;
            --white: #ffffff;
            --text-color: #111111;
            --text-muted: #6b6b6b;
            --accent-color: #4a6b36;
            --border-color: rgba(0,0,0,0.05);
            --wa-green: #25D366;
            --danger-color: #e74c3c;
            --waze-color: #33CCFF;
        }

        /* --- RESET & BASE --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", Roboto, sans-serif;
            background: var(--bg-main);
            color: var(--text-color);
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
        }

        a { text-decoration: none; color: inherit; }
        ul { list-style: none; }
        img { width: 100%; display: block; height: auto; }

        /* --- SEARCH OVERLAY --- */
        .search-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.98); 
            backdrop-filter: blur(10px);
            z-index: 2000; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease, transform 0.3s ease;
            transform: scale(0.95);
        }

        .search-overlay.active {
            opacity: 1;
            pointer-events: all;
            transform: scale(1);
        }

        .search-input {
            width: 90%;
            max-width: 600px;
            font-size: 2.5rem; 
            font-weight: 300;
            border: none;
            border-bottom: 2px solid var(--text-color);
            padding: 1rem 0;
            text-align: center;
            background: transparent;
            color: var(--text-color);
            outline: none;
            transition: border-color 0.3s;
        }

        .search-input:focus { border-bottom-color: var(--accent-color); }
        .search-input::placeholder { color: #ccc; font-weight: 300; }

        .close-search {
            position: absolute;
            top: 2rem;
            right: 2rem;
            font-size: 2rem;
            cursor: pointer;
            color: var(--text-color);
            opacity: 0.5;
            transition: opacity 0.3s, transform 0.3s;
            background: #f0f0f0;
            width: 50px; height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .close-search:hover { opacity: 1; transform: rotate(90deg); background: #e0e0e0; }

        /* --- NAVIGATION --- */
        header {
            position: fixed;
            top: 0; left: 0; width: 100%;
            padding: 1.2rem 2.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            background: rgba(251, 250, 247, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            transition: padding 0.3s;
        }

        .logo-container img {
            height: 35px; width: auto; object-fit: contain;
            cursor: pointer;
        }
        
        nav ul { display: flex; gap: 2.5rem; }
        nav a {
            font-size: 0.85rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-color);
            opacity: 0.7;
            transition: opacity 0.3s;
        }
        nav a:hover, nav a.active-link { opacity: 1; }
        nav a.active-link { color: var(--accent-color); }

        .header-icons { display: flex; gap: 1.5rem; align-items: center; }
        .icon-btn { cursor: pointer; opacity: 0.7; transition: 0.3s; font-size: 1.1rem; position: relative; }
        .icon-btn:hover { opacity: 1; transform: scale(1.1); }

        /* Cart Badge */
        .cart-badge {
            position: absolute;
            top: -5px; right: -8px;
            background: var(--accent-color);
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            display: none; 
        }
        .cart-badge.visible { display: flex; }

        /* Mobile Menu */
        .hamburger { display: none; cursor: pointer; z-index: 1100; font-size: 1.5rem; }
        
        .mobile-menu {
            position: fixed;
            top: 0; right: 0;
            width: 80%;
            height: 100vh;
            background: var(--bg-main);
            z-index: 1050;
            padding: 6rem 2rem;
            transform: translateX(100%);
            transition: transform 0.5s cubic-bezier(0.77, 0, 0.175, 1);
            box-shadow: -5px 0 25px rgba(0,0,0,0.05);
        }
        .mobile-menu.active { transform: translateX(0); }
        
        .close-sidebar {
            position: absolute;
            top: 2rem;
            right: 2rem;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 1100;
        }

        .mobile-menu ul { display: flex; flex-direction: column; gap: 2rem; }
        .mobile-menu a { font-size: 1.5rem; font-weight: 600; color: var(--text-color); opacity: 0.2; }
        .mobile-menu a.active, .mobile-menu a:hover { opacity: 1; }

        /* --- PAGE STRUCTURE --- */
        .page-container { padding-top: 80px; min-height: 100vh; }
        .page {
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.6s ease, transform 0.6s ease;
            padding-bottom: 4rem;
        }
        .page.active { display: block; opacity: 1; transform: translateY(0); }

        /* Page Transition */
        .page-transition {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--accent-color);
            z-index: 5000;
            transform: translateY(100%);
            pointer-events: none;
            transition: transform 0.6s cubic-bezier(0.77, 0, 0.175, 1);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .page-transition.active { transform: translateY(0); }
        
        .transition-logo {
            width: 120px;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.3s ease 0.1s; 
        }
        .page-transition.active .transition-logo { opacity: 1; transform: scale(1); }

        /* --- PRELOADER --- */
        .preloader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-main); z-index: 10000;
            display: flex; justify-content: center; align-items: center;
            transition: transform 0.8s ease;
        }
        .preloader.hide { transform: translateY(-100%); }
        .preloader img { height: 60px; width: auto; }

        /* === HERO === */
        .hero {
            text-align: center;
            padding: 6rem 1.5rem 5rem 1.5rem;
            position: relative;
            height: 90vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .hero-bg-slider {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
        }

        .slide {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background-size: cover;
            background-position: center;
        }

        .slide.active { opacity: 1; }

        .hero-content {
            position: relative;
            z-index: 2;
            background: rgba(255, 255, 255, 0.9);
            padding: 3rem;
            border-radius: 12px;
            backdrop-filter: blur(8px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
            margin-bottom: 5rem;
        }

        .hero h1 { font-size: 3rem; font-weight: 700; letter-spacing: -0.02em; margin-bottom: 1rem; line-height: 1.1; }
        .hero p { color: var(--text-muted); font-size: 1.1rem; max-width: 500px; margin: 0 auto 2rem auto; line-height: 1.6; }

        .dots-container {
            position: absolute; bottom: 2rem; left: 50%; transform: translateX(-50%); z-index: 10; display: flex; gap: 15px;
        }

        .dot {
            width: 12px; height: 12px; border-radius: 50%; background-color: rgba(255, 255, 255, 0.5); cursor: pointer;
            transition: all 0.3s ease; border: 1px solid rgba(0,0,0,0.1);
        }
        .dot:hover { transform: scale(1.2); background-color: rgba(255, 255, 255, 0.8); }
        .dot.active { background-color: var(--text-color); transform: scale(1.3); }

        /* === MENU SECTION & HOME HEADER UPDATE === */
        .menu-section { max-width: 1100px; margin: 0 auto 80px auto; padding: 0 24px; text-align: center; }
        
        .section-header { font-size: 14px; letter-spacing: 0.12em; text-transform: lowercase; color: var(--text-muted); margin-bottom: 48px; }

        /* SPECIFIC UPDATE: Make "New & Seasonal" on Home page Bold, Bigger, and Spaced */
        #home .section-header {
            font-size: 2.5rem; /* Bigger size */
            font-weight: 800; /* Bold/Extra Bold */
            text-transform: uppercase; /* Uppercase for impact */
            letter-spacing: 2px;
            color: var(--text-color); /* Darker for visibility */
            margin-top: 6rem; /* Moved "below more" - increased gap from slideshow */
            margin-bottom: 3rem; /* Adjusted bottom spacing */
        }

        .menu-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
        
        .card-wrapper { 
            display: flex; 
            flex-direction: column; 
            gap: 1rem; 
            transition: transform 0.3s ease; 
        } 
        
        .card-wrapper:hover { transform: translateY(-5px); }
        
        .card-img-full {
            width: 100%; aspect-ratio: 4 / 5; overflow: hidden;
            background: #eee; position: relative;
        }
        .card-img-full img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
        .card-wrapper:hover .card-img-full img { transform: scale(1.05); }

        .item-info { text-align: left; padding: 0 4px; }
        .item-title { font-size: 1rem; font-weight: 600; margin-bottom: 0.2rem; }
        .item-price { font-size: 0.9rem; font-weight: 500; color: var(--text-muted); }
        .item-desc { font-size: 0.8rem; color: #999; line-height: 1.4; margin-top: 0.3rem; }

        .add-to-cart-btn {
            background: var(--bg-main);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 20px;
            margin-top: 0.5rem;
            width: 100%;
            transition: all 0.2s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            z-index: 10;
            position: relative;
        }
        .add-to-cart-btn:hover { background: var(--text-color); color: white; border-color: var(--text-color); }

        .category-nav { display: flex; justify-content: center; gap: 2rem; margin-bottom: 3rem; border-bottom: 1px solid var(--border-color); padding-bottom: 1rem; flex-wrap: wrap;}
        .cat-btn { background: none; border: none; font-family: inherit; font-size: 0.9rem; text-transform: lowercase; letter-spacing: 0.05em; color: var(--text-muted); cursor: pointer; padding-bottom: 5px; transition: 0.3s; }
        .cat-btn.active, .cat-btn:hover { color: var(--text-color); border-bottom: 1px solid var(--text-color); }

        /* === ORDER PAGE LAYOUT === */
        .order-layout {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 1.2fr 0.8fr; 
            gap: 3rem;
            align-items: start;
        }

        .order-summary-container {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
        }

        .summary-list {
            max-height: 400px;
            overflow-y: auto;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }

        /* ORDER ITEM ROW */
        .order-item-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #f0f0f0;
        }
        .order-item-info { display: flex; flex-direction: column; }
        .order-item-name { font-weight: 500; font-size: 0.95rem; }
        .order-item-price { font-size: 0.85rem; color: var(--text-muted); }

        .order-controls { display: flex; align-items: center; gap: 0.8rem; }
        
        .qty-btn {
            width: 28px; height: 28px;
            border-radius: 50%;
            border: 1px solid #ddd;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--text-color);
            transition: 0.2s;
        }
        .qty-btn:hover { background: #f0f0f0; border-color: #ccc; }
        .qty-num { font-size: 1rem; font-weight: 600; width: 20px; text-align: center; }
        
        .remove-btn { color: #ccc; cursor: pointer; transition: 0.3s; font-size: 0.9rem; }
        .remove-btn:hover { color: var(--danger-color); }

        .summary-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.2rem;
            font-weight: 700;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px solid var(--border-color);
        }

        .empty-cart-msg { text-align: center; color: var(--text-muted); padding: 2rem 0; font-style: italic; }

        /* === FORM & INFO === */
        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; }
        .info-box h3 { font-size: 1.5rem; margin-bottom: 1rem; }
        .info-item { margin-bottom: 1rem; font-size: 1rem; color: var(--text-muted); display: flex; align-items: center; gap: 10px; }
        .info-item i { color: var(--accent-color); width: 20px; }
        
        .social-links { display: flex; gap: 1rem; margin-top: 1.5rem; }
        .social-icon {
            width: 45px; height: 45px; border-radius: 50%;
            background: #eee; display: flex; align-items: center; justify-content: center;
            color: #111; font-size: 1.2rem; transition: 0.3s;
        }
        .social-icon:hover { background: var(--accent-color); color: white; }

        /* Pickup Map / Address Styles */
        .pickup-map-container {
            background: #eef5eb;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #d1e7dd;
        }
        .pickup-text { font-weight: 600; color: var(--accent-color); margin-bottom: 0.5rem; font-size: 0.95rem; }
        .map-buttons { display: flex; gap: 1rem; }
        .map-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.6rem 1rem;
            border-radius: 4px;
            text-decoration: none;
            font-size: 0.85rem;
            font-weight: 600;
            color: white;
            transition: 0.3s;
        }
        .btn-google { background-color: #4285F4; }
        .btn-google:hover { background-color: #3367d6; }
        .btn-waze { background-color: var(--waze-color); }
        .btn-waze:hover { background-color: #00aadd; }

        /* Google Maps Embed for About Page */
        .map-embed {
            width: 100%;
            height: 250px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-top: 1.5rem;
        }

        /* --- FORMS --- */
        .form-group { margin-bottom: 1.5rem; }
        .form-input {
            width: 100%; padding: 1rem;
            background: var(--white); border: 1px solid var(--border-color);
            border-radius: 8px; font-family: inherit; outline: none; transition: 0.3s;
        }
        .form-input:focus { border-color: var(--accent-color); }

        /* --- UPDATED DELIVERY CHOICE STYLE --- */
        .delivery-choice-container {
            background: #f0f0f0;
            border-radius: 50px;
            padding: 5px;
            display: flex;
            position: relative;
            margin-bottom: 1.5rem;
        }

        .radio-option { width: 50%; position: relative; z-index: 2; }
        
        /* Hide actual radio input */
        .radio-option input { 
            opacity: 0; 
            width: 100%; 
            height: 100%; 
            position: absolute; 
            top:0; left:0; 
            cursor: pointer; 
            z-index: 3;
        }

        /* Style Label as Button */
        .radio-option label {
            display: block;
            text-align: center;
            padding: 12px 0;
            border-radius: 50px;
            color: var(--text-muted);
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s ease;
            position: relative; z-index: 1;
            font-size: 0.95rem;
        }

        /* Active State */
        .radio-option input:checked + label {
            background: var(--accent-color);
            color: white;
            box-shadow: 0 4px 10px rgba(74, 107, 54, 0.3);
        }

        /* --- Dynamic Options Area --- */
        .delivery-options {
            display: block; /* Always visible now */
            background: rgba(0,0,0,0.02);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            /* Animation handled via JS toggling classes if needed, but we'll just toggle display for simplicity */
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .location-btn {
            background: #eee; color: #333; border: none; padding: 0.5rem 1rem;
            border-radius: 6px; font-size: 0.85rem; cursor: pointer;
            margin-top: 0.5rem; display: flex; align-items: center; gap: 0.5rem; transition: 0.3s;
        }
        .location-btn:hover { background: #ddd; }

        .submit-btn {
            background: var(--wa-green); color: white; border: none;
            padding: 1rem 2rem; border-radius: 50px; font-weight: 600; cursor: pointer; transition: 0.3s;
            width: 100%; display: flex; justify-content: center; align-items: center; gap: 10px;
        }
        .submit-btn:hover { background: #1ebc57; }
        .submit-btn:disabled { background: #ccc; cursor: not-allowed; }

        .wa-icon { font-size: 1.2rem; color: white; }

        /* === MODALS === */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(4px);
            z-index: 3000;
            display: none;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .modal-overlay.active { display: flex; opacity: 1; }

        .modal-box {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        .modal-overlay.active .modal-box { transform: scale(1); }

        .modal-title { font-size: 1.2rem; font-weight: 600; margin-bottom: 0.5rem; }
        .modal-msg { color: var(--text-muted); margin-bottom: 1.5rem; font-size: 0.95rem; line-height: 1.4; }
        
        .modal-actions { display: flex; gap: 1rem; justify-content: center; }
        .modal-btn {
            padding: 0.8rem 2rem; border-radius: 8px; border: none; cursor: pointer; font-weight: 600; transition: 0.2s;
        }
        .btn-yes { background: var(--accent-color); color: white; }
        .btn-yes:hover { background: var(--accent-color-dark); }
        .btn-no { background: #eee; color: #333; }
        .btn-no:hover { background: #ddd; }

        /* Summary Text in Modal */
        .modal-summary-text { 
            text-align: left; 
            background: #f9f9f9; 
            padding: 1rem; 
            border-radius: 8px; 
            margin-bottom: 1.5rem; 
            font-size: 0.9rem;
            color: #333;
        }
        .modal-summary-row { display: flex; justify-content: space-between; border-bottom: 1px dashed #ccc; padding: 0.5rem 0; }

        /* --- FOOTER --- */
        footer {
            text-align: center; padding: 3rem; border-top: 1px solid var(--border-color);
            color: var(--text-muted); font-size: 0.8rem; background: var(--bg-main);
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 900px) {
            .menu-grid { grid-template-columns: repeat(2, 1fr); }
            .order-layout { grid-template-columns: 1fr; gap: 2rem; }
            .info-grid { grid-template-columns: 1fr; }
            nav { display: none; }
            .hamburger { display: block; }
            .search-input { font-size: 1.8rem; }
            #home .section-header { font-size: 2rem; margin-top: 4rem; } 
        }
        
        @media (max-width: 480px) {
            .menu-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; } 
            .item-title { font-size: 0.85rem; }
            .item-price { font-size: 0.8rem; }
            .item-desc { font-size: 0.7rem; line-height: 1.2; }
            .menu-section { padding: 0 1rem; } 
            .hero h1 { font-size: 2.2rem; }
            .close-search { width: 40px; height: 40px; top: 1rem; right: 1rem; font-size: 1.5rem; }
            .radio-option label { font-size: 0.85rem; padding: 10px 0; }
        }
    </style>
</head>
<body>

    <!-- Preloader -->
    <div class="preloader" id="preloader">
        <img src="https://raw.githubusercontent.com/ddnetwork-ent/mory-matcha/refs/heads/main/MORY%20LOGO-green.png" alt="Mory Logo">
    </div>

    <!-- IMPROVED Search Overlay -->
    <div class="search-overlay" id="searchOverlay">
        <div class="close-search" onclick="toggleSearch()">
            <i class="fas fa-times"></i>
        </div>
        <input type="text" class="search-input" id="searchInput" placeholder="Search menu..." autocomplete="off">
    </div>

    <!-- Page Transition -->
    <div class="page-transition" id="pageTransition">
        <img src="https://i.ibb.co/20wnRvgq/MORY-LOGO-white.png" class="transition-logo" alt="MORY">
    </div>

    <!-- Confirm Add Modal -->
    <div class="modal-overlay" id="confirmModal">
        <div class="modal-box">
            <div class="modal-title">Item Already Added</div>
            <p class="modal-msg">Do you want to add another one?</p>
            <div class="modal-actions">
                <button class="modal-btn btn-yes" onclick="confirmAdd(true)">Yes</button>
                <button class="modal-btn btn-no" onclick="confirmAdd(false)">No</button>
            </div>
        </div>
    </div>

    <!-- Confirm Delete Modal -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal-box">
            <div class="modal-title" style="color: var(--danger-color)">Remove Item?</div>
            <p class="modal-msg">Are you sure you want to remove this item from your order?</p>
            <div class="modal-actions">
                <button class="modal-btn btn-yes" style="background: var(--danger-color);" onclick="confirmDelete(true)">Yes, Remove</button>
                <button class="modal-btn btn-no" onclick="confirmDelete(false)">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Final Confirmation Modal -->
    <div class="modal-overlay" id="finalConfirmModal">
        <div class="modal-box">
            <div class="modal-title">Confirm Order</div>
            <p class="modal-msg">Please verify your order and location before sending.</p>
            
            <div class="modal-summary-text" id="finalSummaryContent">
                <!-- Content injected by JS -->
            </div>

            <div class="modal-actions">
                <button class="modal-btn btn-yes" onclick="finalizeWhatsApp()">Confirm & Send</button>
                <button class="modal-btn btn-no" onclick="closeModal('finalConfirmModal')">Edit</button>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header>
        <a href="#" class="logo-container" onclick="navigateTo('home', event)">
            <img src="https://raw.githubusercontent.com/ddnetwork-ent/mory-matcha/refs/heads/main/MORY%20LOGO-green.png" alt="MORY">
        </a>

        <!-- Desktop Nav -->
        <nav>
            <ul>
                <li><a href="#" class="nav-link active-link" data-target="home" onclick="navigateTo('home', event)">Home</a></li>
                <li><a href="#" class="nav-link" data-target="menu" onclick="navigateTo('menu', event)">Menu</a></li>
                <li><a href="#" class="nav-link" data-target="about" onclick="navigateTo('about', event)">About</a></li>
            </ul>
        </nav>

        <!-- Icons -->
        <div class="header-icons">
            <div class="icon-btn" onclick="toggleSearch()"><i class="fas fa-search"></i></div>
            
            <!-- Cart Button (With Badge) -->
            <div class="icon-btn" onclick="navigateTo('order', event)">
                <i class="fas fa-shopping-bag"></i>
                <div class="cart-badge" id="cartBadge">0</div>
            </div>
            
            <div class="hamburger" onclick="toggleMobileMenu()"><i class="fas fa-bars"></i></div>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="close-sidebar" onclick="toggleMobileMenu()">
            <i class="fas fa-times"></i>
        </div>
        <ul>
            <li><a href="#" onclick="navigateTo('home', event); toggleMobileMenu()">Home</a></li>
            <li><a href="#" onclick="navigateTo('menu', event); toggleMobileMenu()">Menu</a></li>
            <li><a href="#" onclick="navigateTo('order', event); toggleMobileMenu()">Order</a></li>
            <li><a href="#" onclick="navigateTo('about', event); toggleMobileMenu()">About</a></li>
        </ul>
        <div style="margin-top: 3rem; border-top: 1px solid #ddd; padding-top: 1rem;">
            <div class="info-item"><i class="fas fa-map-marker-alt"></i> Zeta Fasa 1, UiTM Tapah</div>
            <div class="info-item"><i class="fas fa-clock"></i> Daily: 6 PM - 11 PM</div>
        </div>
    </div>

    <div class="page-container">
        
        <!-- === HOME PAGE === -->
        <section id="home" class="page active">
            <div class="hero">
                <div class="hero-bg-slider">
                    <div class="slide active" style="background-image: url('https://i.ibb.co/fzq6R9mG/background-img1.jpg');"></div>
                    <div class="slide" style="background-image: url('https://i.ibb.co/Gvfk9HKM/background-img2.jpg');"></div>
                </div>
                
                <div class="dots-container" id="dotsContainer">
                    <!-- Dots generated by JS -->
                </div>

                <div class="hero-content">
                    <h1>Energize.<br>Calm.<br>Elevate.</h1>
                    <p>Mory is a modern matcha brand that blends tradition with lifestyle.</p>
                    <button onclick="navigateTo('menu', event)" class="submit-btn" style="background:var(--text-color)">View Menu</button>
                </div>
            </div>

            <section class="menu-section">
                <div class="section-header">new & seasonal</div>
                <div class="menu-grid">
                    <!-- Note: Wrapper no longer has onclick -->
                    <div class="card-wrapper">
                        <div class="card-img-full"><img src="https://i.ibb.co/zHjDJB8F/Matcho.jpg" alt="Matcho"></div>
                        <div class="item-info">
                            <div class="item-title">Matcho</div>
                            <div class="item-price">RM 13.00</div>
                        </div>
                        <!-- Button has the click event -->
                        <div class="add-to-cart-btn" onclick="initiateAdd('Matcho', 13)"><i class="fas fa-plus"></i> Add</div>
                    </div>
                    <div class="card-wrapper">
                        <div class="card-img-full"><img src="https://i.ibb.co/CKKSCYJ0/Matcha-Taro.jpg" alt="Taro Matcha"></div>
                        <div class="item-info">
                            <div class="item-title">Taro Matcha</div>
                            <div class="item-price">RM 13.00</div>
                        </div>
                        <div class="add-to-cart-btn" onclick="initiateAdd('Taro Matcha', 13)"><i class="fas fa-plus"></i> Add</div>
                    </div>
                    <div class="card-wrapper">
                        <div class="card-img-full"><img src="https://i.ibb.co/N6YHfYxf/BISCOFF-MOFFLE.jpg" alt="Biscoff Moffle"></div>
                        <div class="item-info">
                            <div class="item-title">Biscoff Moffle</div>
                            <div class="item-price">RM 10.00</div>
                        </div>
                        <div class="add-to-cart-btn" onclick="initiateAdd('Biscoff Moffle', 10)"><i class="fas fa-plus"></i> Add</div>
                    </div>
                    <div class="card-wrapper">
                        <div class="card-img-full"><img src="https://i.ibb.co/DHPnpMRz/Matcha-Latte.jpg" alt="Matcha Latte"></div>
                        <div class="item-info">
                            <div class="item-title">Matcha Latte</div>
                            <div class="item-price">RM 10.00</div>
                        </div>
                        <div class="add-to-cart-btn" onclick="initiateAdd('Matcha Latte', 10)"><i class="fas fa-plus"></i> Add</div>
                    </div>
                </div>
            </section>
        </section>

        <!-- === MENU PAGE === -->
        <section id="menu" class="page">
            <div class="menu-section">
                <div class="section-header" style="font-size: 24px; margin-bottom: 20px;">Menu</div>
                <div class="category-nav">
                    <button class="cat-btn active" onclick="filterMenu('all', this)">all</button>
                    <button class="cat-btn" onclick="filterMenu('moffle', this)">moffle series</button>
                    <button class="cat-btn" onclick="filterMenu('matcha', this)">matcha series</button>
                    <button class="cat-btn" onclick="filterMenu('refresher', this)">refresher series</button>
                </div>

                <div class="menu-grid">
                    <!-- MOFFLE SERIES -->
                    <div class="grid-item" data-cat="moffle">
                        <div class="card-wrapper">
                            <div class="card-img-full"><img src="https://i.ibb.co/N2j6qT48/CLASSIC-MOFFLE.jpg" alt="Classic Moffle"></div>
                            <div class="item-info">
                                <div class="item-title">Classic Moffle</div>
                                <div class="item-price">RM 8.00</div>
                                <div class="item-desc">Crispy on the outside, fluffy on the inside.</div>
                            </div>
                            <div class="add-to-cart-btn" onclick="initiateAdd('Classic Moffle', 8)"><i class="fas fa-plus"></i> Add</div>
                        </div>
                    </div>

                    <div class="grid-item" data-cat="moffle">
                        <div class="card-wrapper">
                            <div class="card-img-full"><img src="https://i.ibb.co/N6YHfYxf/BISCOFF-MOFFLE.jpg" alt="Biscoff Moffle"></div>
                            <div class="item-info">
                                <div class="item-title">Biscoff Moffle</div>
                                <div class="item-price">RM 10.00</div>
                                <div class="item-desc">Golden moffle topped with rich, caramelised Biscoff crumble.</div>
                            </div>
                            <div class="add-to-cart-btn" onclick="initiateAdd('Biscoff Moffle', 10)"><i class="fas fa-plus"></i> Add</div>
                        </div>
                    </div>

                    <div class="grid-item" data-cat="moffle">
                        <div class="card-wrapper">
                            <div class="card-img-full"><img src="https://i.ibb.co/k2555Vth/CHOCOLATE-MOFFLE.jpg" alt="Chocolate Moffle"></div>
                            <div class="item-info">
                                <div class="item-title">Chocolate Moffle</div>
                                <div class="item-price">RM 8.00</div>
                                <div class="item-desc">Freshly baked moffle drizzled with smooth chocolate sauce.</div>
                            </div>
                            <div class="add-to-cart-btn" onclick="initiateAdd('Chocolate Moffle', 8)"><i class="fas fa-plus"></i> Add</div>
                        </div>
                    </div>

                    <!-- MATCHA SERIES -->
                    <div class="grid-item" data-cat="matcha">
                        <div class="card-wrapper">
                            <div class="card-img-full"><img src="https://i.ibb.co/DHPnpMRz/Matcha-Latte.jpg" alt="Matcha Latte"></div>
                            <div class="item-info">
                                <div class="item-title">Matcha Latte</div>
                                <div class="item-price">RM 10.00</div>
                                <div class="item-desc">Smooth, earthy matcha blended with creamy milk.</div>
                            </div>
                            <div class="add-to-cart-btn" onclick="initiateAdd('Matcha Latte', 10)"><i class="fas fa-plus"></i> Add</div>
                        </div>
                    </div>

                    <div class="grid-item" data-cat="matcha">
                        <div class="card-wrapper">
                            <div class="card-img-full"><img src="https://i.ibb.co/8DLhMzbV/STRAWBERRY-MATCHA.jpg" alt="Strawberry Matcha"></div>
                            <div class="item-info">
                                <div class="item-title">Strawberry Matcha</div>
                                <div class="item-price">RM 12.00</div>
                                <div class="item-desc">A refreshing mix of vibrant strawberry and premium matcha.</div>
                            </div>
                            <div class="add-to-cart-btn" onclick="initiateAdd('Strawberry Matcha', 12)"><i class="fas fa-plus"></i> Add</div>
                        </div>
                    </div>

                    <div class="grid-item" data-cat="matcha">
                        <div class="card-wrapper">
                            <div class="card-img-full"><img src="https://i.ibb.co/CKKSCYJ0/Matcha-Taro.jpg" alt="Taro Matcha"></div>
                            <div class="item-info">
                                <div class="item-title">Taro Matcha</div>
                                <div class="item-price">RM 13.00</div>
                                <div class="item-desc">Creamy taro paired with aromatic matcha.</div>
                            </div>
                            <div class="add-to-cart-btn" onclick="initiateAdd('Taro Matcha', 13)"><i class="fas fa-plus"></i> Add</div>
                        </div>
                    </div>

                    <div class="grid-item" data-cat="matcha">
                        <div class="card-wrapper">
                            <div class="card-img-full"><img src="https://i.ibb.co/zHjDJB8F/Matcho.jpg" alt="Matcho"></div>
                            <div class="item-info">
                                <div class="item-title">Matcho</div>
                                <div class="item-price">RM 13.00</div>
                                <div class="item-desc">Where matcha meets chocolate. Rich cocoa undertones.</div>
                            </div>
                            <div class="add-to-cart-btn" onclick="initiateAdd('Matcho', 13)"><i class="fas fa-plus"></i> Add</div>
                        </div>
                    </div>

                    <div class="grid-item" data-cat="matcha">
                        <div class="card-wrapper">
                            <div class="card-img-full"><img src="https://i.ibb.co/b8Hg6sp/MANGO-MATCHA.jpg" alt="Mango Matcha"></div>
                            <div class="item-info">
                                <div class="item-title">Mango Matcha</div>
                                <div class="item-price">RM 14.00</div>
                                <div class="item-desc">Tropical mango sweetness balanced with earthy matcha.</div>
                            </div>
                            <div class="add-to-cart-btn" onclick="initiateAdd('Mango Matcha', 14)"><i class="fas fa-plus"></i> Add</div>
                        </div>
                    </div>

                    <div class="grid-item" data-cat="matcha">
                        <div class="card-wrapper">
                            <div class="card-img-full"><img src="https://i.ibb.co/SDtWRm9f/BLUEBERRY-MATCHA.jpg" alt="Blueberry Matcha"></div>
                            <div class="item-info">
                                <div class="item-title">Blueberry Matcha</div>
                                <div class="item-price">RM 14.00</div>
                                <div class="item-desc">Juicy blueberry notes combined with smooth matcha.</div>
                            </div>
                            <div class="add-to-cart-btn" onclick="initiateAdd('Blueberry Matcha', 14)"><i class="fas fa-plus"></i> Add</div>
                        </div>
                    </div>

                    <!-- REFRESHER SERIES (COMBINED) -->
                    <div class="grid-item" data-cat="refresher">
                        <div class="card-wrapper">
                            <div class="card-img-full">
                                <img src="https://i.ibb.co/m56Mrssy/PHOTO-2026-01-29-15-02-04.jpg" alt="Refresher Series">
                            </div>
                            <div class="item-info">
                                <div class="item-title">Refresher Series</div>
                                <div class="item-price">RM 8.00</div>
                                <div class="item-desc">Available in Mango & Strawberry.</div>
                            </div>
                            <div class="add-to-cart-btn" onclick="initiateAdd('Refresher Series', 8)"><i class="fas fa-plus"></i> Add</div>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- === ORDER / CHECKOUT PAGE === -->
        <section id="order" class="page">
            <div class="menu-section">
                <div class="section-header" style="font-size: 24px;">place your order</div>
                
                <div class="order-layout">
                    <!-- LEFT: Order Summary -->
                    <div class="order-summary-container">
                        <h3 style="margin-bottom: 1.5rem;">Your Order</h3>
                        <div id="cartList" class="summary-list">
                            <!-- Items injected here -->
                            <div class="empty-cart-msg">
                                Your cart is empty.<br>
                                <span style="font-size: 0.85rem;">Go to Menu to add items.</span>
                            </div>
                        </div>
                        
                        <div class="summary-total">
                            <span>Total:</span>
                            <span id="cartTotal">RM 0.00</span>
                        </div>
                    </div>

                    <!-- RIGHT: Customer Details Form -->
                    <div>
                        <h3 style="margin-bottom: 1.5rem;">Customer Details</h3>
                        
                        <form id="orderForm">
                            <div class="form-group"><input type="text" id="customerName" class="form-input" placeholder="Name *" required></div>
                            <div class="form-group"><input type="tel" id="customerPhone" class="form-input" placeholder="Phone Number *" required></div>
                                
                            <!-- UPDATED: Order Method Toggle (Tabs) -->
                            <div class="delivery-choice-container">
                                <div class="radio-option">
                                    <input type="radio" name="orderMethod" id="methodPickup" value="Pickup" checked onclick="toggleDeliveryOptions('pickup')">
                                    <label for="methodPickup">Pick Up</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" name="orderMethod" id="methodDelivery" value="Delivery" onclick="toggleDeliveryOptions('delivery')">
                                    <label for="methodDelivery">Delivery</label>
                                </div>
                            </div>

                            <!-- Dynamic Location/Address Area -->
                            <div id="deliveryOptionsContainer" class="delivery-options">
                                <!-- Delivery Content -->
                                <div id="deliveryInputs" style="display: none;">
                                    <div class="form-group">
                                        <input type="text" id="addressInput" class="form-input" placeholder="Delivery Address *">
                                        <button type="button" class="location-btn" onclick="getCurrentLocation()">
                                            <i class="fas fa-map-marker-alt"></i> Use My Location
                                        </button>
                                    </div>
                                </div>

                                <!-- Pickup Content -->
                                <div id="pickupInputs" class="pickup-map-container">
                                    <div class="pickup-text">
                                        <i class="fas fa-store"></i> Pick Up At Store
                                    </div>
                                    <div style="font-size: 0.9rem; color: #555; margin-bottom: 1rem;">Zeta Fasa 1 , UiTM Cawangan Perak Kampus Tapah</div>
                                    <div class="map-buttons">
                                        <a href="https://www.google.com/maps/search/?api=1&query=UiTM+Cawangan+Perak+Kampus+Tapah" target="_blank" class="map-btn btn-google">
                                            <i class="fab fa-google"></i> Maps
                                        </a>
                                        <a href="https://waze.com/ul?ll=4.184523,101.152837&navigate=yes" target="_blank" class="map-btn btn-waze">
                                            <i class="fas fa-location-arrow"></i> Waze
                                        </a>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <textarea id="orderDetails" class="form-input" rows="4" placeholder="Additional Order Instructions (Optional)"></textarea>
                            </div>
                            
                            <button type="button" class="submit-btn" id="finalSubmitBtn" onclick="validateAndConfirmOrder()" disabled>
                                <i class="fab fa-whatsapp wa-icon"></i> Send Order to WhatsApp
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- === ABOUT PAGE === -->
        <section id="about" class="page">
            <div class="menu-section">
                <div class="section-header" style="font-size: 24px;">about mory</div>
                <div class="info-grid">
                    <div class="info-box">
                        <h3>Our Location</h3>
                        <div class="info-item"><i class="fas fa-map-marker-alt"></i> Zeta Fasa 1 , UiTM Cawangan Perak Kampus Tapah</div>
                        
                        <!-- Embedded Google Map -->
                        <div class="map-embed">
                            <!-- FIXED MAP EMBED URL -->
                            <iframe 
                                width="100%" 
                                height="100%" 
                                frameborder="0" 
                                style="border:0" 
                                src="https://maps.google.com/maps?q=UiTM+Cawangan+Perak+Kampus+Tapah&t=&z=13&ie=UTF8&iwloc=&output=embed" 
                                allowfullscreen>
                            </iframe>
                        </div>
                    </div>
                    <div class="info-box">
                        <h3>Opening Hours</h3>
                        <div class="info-item"><i class="fas fa-clock"></i> Open Daily</div>
                        <div class="info-item" style="margin-left: 35px; font-weight:600; color:var(--accent-color)">6:00 PM - 11:00 PM</div>
                        <div class="info-item" style="margin-top:1rem;"><i class="fas fa-phone"></i> +60 11-6952 6811</div>
                        <div class="info-item"><i class="fas fa-envelope"></i> chehazieq@gmail.com</div>
                        
                        <h3 style="margin-top:2rem; margin-bottom: 1rem;">Get Directions</h3>
                        <div class="map-buttons" style="justify-content: flex-start;">
                            <a href="https://www.google.com/maps/search/?api=1&query=UiTM+Cawangan+Perak+Kampus+Tapah" target="_blank" class="map-btn btn-google">
                                <i class="fab fa-google"></i> Maps
                            </a>
                            <a href="https://waze.com/ul?ll=4.184523,101.152837&navigate=yes" target="_blank" class="map-btn btn-waze">
                                <i class="fas fa-location-arrow"></i> Waze
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <footer>
    <p>
        &copy; 2026 MORY. All Rights Reserved.</p>Developed by <a href="https://www.ddnet.my" target="_blank" rel="noopener" class="dd-link">DDNetwork</a>
    </p>
    </footer>

     <style>
.dd-link {
    color: #007BFF; /* blue */
    text-decoration: none;
    font-weight: 500;
}

.dd-link:hover {
    text-decoration: underline;
}
    </style>


    <script>
        // --- 1. Preloader ---
        window.addEventListener('load', () => {
            setTimeout(() => document.getElementById('preloader').classList.add('hide'), 1000);
        });

        // --- 2. Navigation Logic ---
        function navigateTo(pageId, event) {
            if(event) event.preventDefault();
            const overlay = document.getElementById('pageTransition');
            const targetPage = document.getElementById(pageId);
            const navLinks = document.querySelectorAll('.nav-link');

            overlay.classList.add('active');

            setTimeout(() => {
                document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                if(targetPage) {
                    targetPage.classList.add('active');
                    window.scrollTo(0, 0);
                }
                navLinks.forEach(link => {
                    link.classList.remove('active-link');
                    if(link.dataset.target === pageId) link.classList.add('active-link');
                });
                setTimeout(() => overlay.classList.remove('active'), 100);
            }, 600);
        }

        // --- 3. Mobile Menu ---
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('active');
            const icon = document.querySelector('.hamburger i');
            if(menu.classList.contains('active')) {
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-times');
            } else {
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            }
        }

        // --- 4. Search Toggle ---
        function toggleSearch() {
            const searchOverlay = document.getElementById('searchOverlay');
            const input = document.getElementById('searchInput');
            const isActive = searchOverlay.classList.contains('active');

            if (!isActive) {
                searchOverlay.classList.add('active');
                document.body.style.overflow = 'hidden';
                setTimeout(() => input.focus(), 300);
            } else {
                searchOverlay.classList.remove('active');
                document.body.style.overflow = 'auto';
                input.blur();
            }
        }

        // --- 5. Menu Filtering ---
        function filterMenu(category, btn) {
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            const items = document.querySelectorAll('.grid-item');
            items.forEach(item => {
                item.style.display = (category === 'all' || item.dataset.cat === category) ? 'block' : 'none';
            });
        }

        // --- 6. Hero Slideshow ---
        let slideIndex = 0;
        const slides = document.querySelectorAll('.slide');
        
        function showSlides() {
            slides.forEach((slide, index) => {
                slide.classList.remove('active');
                if (index === slideIndex) slide.classList.add('active');
            });
            slideIndex++;
            if (slideIndex >= slides.length) slideIndex = 0;
        }
        
        if(slides.length > 0) setInterval(showSlides, 5000);

        const dotsContainer = document.getElementById('dotsContainer');
        if(slides.length > 0 && dotsContainer) {
            slides.forEach((_, index) => {
                const dot = document.createElement('div');
                dot.classList.add('dot');
                if (index === 0) dot.classList.add('active');
                dot.addEventListener('click', () => { slideIndex = index; showSlideManual(index); });
                dotsContainer.appendChild(dot);
            });
        }

        function showSlideManual(n) {
            slides.forEach(s => s.classList.remove('active'));
            slides[n].classList.add('active');
            const dots = document.querySelectorAll('.dot');
            dots.forEach(d => d.classList.remove('active'));
            dots[n].classList.add('active');
            slideIndex = n + 1;
        }

        // --- 7. CART & QUANTITY LOGIC ---
        
        let cart = []; // Structure: [{name, price, qty}]
        let pendingItem = null; 
        let pendingDeleteItem = null;

        // Trigger Add (Strict Button Click)
        function initiateAdd(name, price) {
            const existingItem = cart.find(item => item.name === name);

            if (existingItem) {
                pendingItem = name;
                document.getElementById('confirmModal').classList.add('active');
            } else {
                addToCartInternal(name, price, 1);
                showToast(`Added ${name}`);
            }
        }

        // Handle Modal Confirmation (Add)
        function confirmAdd(shouldAdd) {
            document.getElementById('confirmModal').classList.remove('active');
            
            if (shouldAdd && pendingItem) {
                const item = cart.find(i => i.name === pendingItem);
                if (item) {
                    item.qty++;
                    updateCartUI();
                    showToast(`Added another ${pendingItem}`);
                }
            }
            pendingItem = null;
        }

        // Internal Add Function
        function addToCartInternal(name, price, qty) {
            cart.push({ name, price, qty });
            updateCartUI();
        }

        // Update Cart Badge & Render
        function updateCartUI() {
            // Badge
            const badge = document.getElementById('cartBadge');
            const count = cart.reduce((sum, item) => sum + item.qty, 0);
            badge.innerText = count;
            badge.classList.add('visible');

            // If on Order page, re-render list
            if(document.getElementById('order').classList.contains('active')) {
                renderCart();
            }
        }

        // Render Cart List with Controls
        function renderCart() {
            const cartList = document.getElementById('cartList');
            const totalEl = document.getElementById('cartTotal');
            const submitBtn = document.getElementById('finalSubmitBtn');
            const emptyMsg = document.querySelector('.empty-cart-msg');

            cartList.innerHTML = '';
            let total = 0;

            if(cart.length === 0) {
                cartList.innerHTML = `
                    <div class="empty-cart-msg">
                        Your cart is empty.<br>
                        <span style="font-size: 0.85rem;">Go to Menu to add items.</span>
                    </div>`;
                totalEl.innerText = 'RM 0.00';
                submitBtn.disabled = true;
                return;
            }

            // Generate Rows
            cart.forEach((item) => {
                total += (item.price * item.qty);
                const div = document.createElement('div');
                div.className = 'order-item-row';
                div.innerHTML = `
                    <div class="order-item-info">
                        <span class="order-item-name">${item.name}</span>
                        <span class="order-item-price">RM ${item.price.toFixed(2)}</span>
                    </div>
                    <div class="order-controls">
                        <button class="qty-btn" onclick="changeQty('${item.name}', -1)">-</button>
                        <span class="qty-num">${item.qty}</span>
                        <button class="qty-btn" onclick="changeQty('${item.name}', 1)">+</button>
                        <i class="fas fa-trash remove-btn" onclick="initiateDelete('${item.name}')"></i>
                    </div>
                `;
                cartList.appendChild(div);
            });

            totalEl.innerText = `RM ${total.toFixed(2)}`;
            submitBtn.disabled = false;
        }

        // Change Quantity (+ / -)
        function changeQty(name, delta) {
            const item = cart.find(i => i.name === name);
            if (item) {
                item.qty += delta;
                if (item.qty <= 0) {
                    // If qty drops to 0, show delete modal
                    pendingDeleteItem = name;
                    document.getElementById('deleteModal').classList.add('active');
                    // Revert visually if cancelled in modal, handled in logic
                } else {
                    updateCartUI();
                }
            }
        }

        // Initiate Delete (Calls Modal)
        function initiateDelete(name) {
            pendingDeleteItem = name;
            document.getElementById('deleteModal').classList.add('active');
        }

        // Handle Delete Confirmation
        function confirmDelete(shouldDelete) {
            document.getElementById('deleteModal').classList.remove('active');
            
            if (shouldDelete && pendingDeleteItem) {
                cart = cart.filter(i => i.name !== pendingDeleteItem);
                updateCartUI();
                showToast("Item removed");
            } else if (!shouldDelete && pendingDeleteItem) {
                // If cancelled and qty was 0 (triggered by -1), revert qty to 1
                const item = cart.find(i => i.name === pendingDeleteItem);
                if(item) item.qty = 1;
                updateCartUI();
            }
            pendingDeleteItem = null;
        }

        function showToast(msg) {
            const toast = document.createElement('div');
            toast.innerText = msg;
            toast.style.position = 'fixed';
            toast.style.bottom = '20px';
            toast.style.left = '50%';
            toast.style.transform = 'translateX(-50%)';
            toast.style.background = 'var(--text-color)';
            toast.style.color = 'white';
            toast.style.padding = '10px 20px';
            toast.style.borderRadius = '20px';
            toast.style.fontSize = '0.9rem';
            toast.style.zIndex = '9999';
            toast.style.animation = 'slideFade 2s ease forwards';
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 2000);
        }

        const style = document.createElement('style');
        style.innerHTML = `
            @keyframes slideFade {
                0% { opacity: 0; transform: translateY(20px); }
                10% { opacity: 1; transform: translateY(0); }
                90% { opacity: 1; transform: translateY(0); }
                100% { opacity: 0; transform: translateY(-20px); }
            }
        `;
        document.head.appendChild(style);

        // --- 8. ORDER PAGE LOGIC ---

        // Toggle Delivery vs Pickup options
        function toggleDeliveryOptions(type) {
            const container = document.getElementById('deliveryOptionsContainer');
            const deliveryDiv = document.getElementById('deliveryInputs');
            const pickupDiv = document.getElementById('pickupInputs');
            const addressInput = document.getElementById('addressInput');
            const pickupRadios = document.getElementsByName('orderMethod');

            // Ensure container is visible
            container.style.display = 'block';

            if (type === 'delivery') {
                deliveryDiv.style.display = 'block';
                pickupDiv.style.display = 'none';
                addressInput.required = true;
            } else {
                // Pickup
                deliveryDiv.style.display = 'none';
                pickupDiv.style.display = 'block'; 
                addressInput.required = false;
            }
        }

        // Get Current Location (For Delivery)
        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    const lat = position.coords.latitude.toFixed(6);
                    const lon = position.coords.longitude.toFixed(6);
                    const addressInput = document.getElementById('addressInput');
                    addressInput.value = `Lat: ${lat}, Lon: ${lon}`;
                }, (error) => {
                    alert("Unable to retrieve your location. Please type manually.");
                    console.error(error);
                });
            } else {
                alert("Geolocation is not supported by this browser.");
            }
        }

        // --- 9. VALIDATION & FINAL CONFIRMATION ---

        function validateAndConfirmOrder() {
            // 1. Check if cart is empty
            if(cart.length === 0) {
                alert("Your cart is empty. Please add items from menu.");
                return;
            }

            // 2. Validate Form
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            const method = document.querySelector('input[name="orderMethod"]:checked').value;
            const addressInput = document.getElementById('addressInput');
            const details = document.getElementById('orderDetails').value;

            if(!name || !phone) {
                alert("Please fill in your Name and Phone Number.");
                return;
            }

            // 3. Validate Address if Delivery
            if (method === 'Delivery' && !addressInput.value) {
                alert("Please enter a delivery address.");
                return;
            }

            // 4. Prepare Summary Text for Modal
            let summaryHTML = `<div class="modal-summary-row"><span>Name:</span><span>${name}</span></div>`;
            summaryHTML += `<div class="modal-summary-row"><span>Phone:</span><span>${phone}</span></div>`;
            summaryHTML += `<div class="modal-summary-row"><span>Type:</span><span>${method}</span></div>`;

            if (method === 'Delivery') {
                summaryHTML += `<div class="modal-summary-row"><span>Address:</span><span>${addressInput.value}</span></div>`;
            } else {
                summaryHTML += `<div class="modal-summary-row"><span>Address:</span><span>Zeta Fasa 1, UiTM Tapah (Pickup)</span></div>`;
            }

            summaryHTML += `<br><div style="margin-top:1rem; font-weight:600; color:#111;">ORDER:</div>`;
            
            cart.forEach(item => {
                summaryHTML += `<div style="font-size: 0.85rem; margin-bottom: 0.3rem; display:flex; justify-content:space-between;">
                    <span>x${item.qty} ${item.name}</span>
                    <span>RM ${(item.price * item.qty).toFixed(2)}</span>
                </div>`;
            });

            // Total
            const total = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
            summaryHTML += `<div style="margin-top:1rem; padding-top:0.5rem; border-top:1px solid #eee; display:flex; justify-content:space-between; font-weight:700;">
                <span>TOTAL</span>
                <span>RM ${total.toFixed(2)}</span>
            </div>`;

            if(details) {
                summaryHTML += `<div style="margin-top:1rem; font-size:0.85rem; color:#666; font-style:italic;">Notes: ${details}</div>`;
            }

            document.getElementById('finalSummaryContent').innerHTML = summaryHTML;

            // Show Modal
            document.getElementById('finalConfirmModal').classList.add('active');
        }

        // Finalize WhatsApp Send
        function finalizeWhatsApp() {
            const modal = document.getElementById('finalConfirmModal');
            modal.classList.remove('active');

            // Gather Data (already validated)
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            const method = document.querySelector('input[name="orderMethod"]:checked').value;
            const details = document.getElementById('orderDetails').value;
            const addressVal = document.getElementById('addressInput').value;
            
            // Build Message
            let message = `*NEW ORDER*\n\n`;
            message += `Name: ${name}\n`;
            message += `Phone: ${phone}\n`;
            message += `Type: ${method}\n`;

            if (method === 'Delivery') {
                message += `Address: ${addressVal}\n`;
            } else {
                message += `Address: Zeta Fasa 1, UiTM Tapah (Pickup)\n`;
            }

            message += `\n*ORDER ITEMS*\n`;
            cart.forEach(item => {
                message += `- ${item.name} (x${item.qty}) - RM ${(item.price * item.qty).toFixed(2)}\n`;
            });

            const total = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
            message += `\n*TOTAL AMOUNT*\nRM ${total.toFixed(2)}`;

            if(details) {
                message += `\n\n*ADDITIONAL NOTES*\n${details}`;
            }

            // Open WA
            const waNumber = "601169526811";
            const url = `https://wa.me/${waNumber}?text=${encodeURIComponent(message)}`;
            
            window.open(url, '_blank');
        }

        // --- 10. Modal Utilities ---
        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
        }

        // --- 11. Order Page Initialization ---
        const orderObserver = new MutationObserver((mutations) => {
            if (document.getElementById('order').classList.contains('active')) {
                renderCart();
                // Force default state to Pickup (Map visible, Address hidden)
                toggleDeliveryOptions('pickup'); 
            }
        });
        orderObserver.observe(document.getElementById('order'), { attributes: true });

    </script>
</body>
</html>
